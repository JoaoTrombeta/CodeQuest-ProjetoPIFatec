<!doctype html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  <title>Cod&Cards</title>
  <link rel="stylesheet" href="style.css">

  <style>
    /* Efeitos visuais da altern√¢ncia de turno */
    .player {
      transition: filter 0.4s ease, opacity 0.4s ease;
    }

    .blurred {
      filter: blur(10px);
      opacity: 0.4;
      pointer-events: none;
    }

    .status-bar {
      transition: visibility 0.3s ease, opacity 0.3s ease;
    }

    .status-bar.hidden {
      visibility: hidden;
      opacity: 0;
    }
  </style>
</head>

<body>
  <header class="top" role="banner">
    <h1 tabindex="0">Cod&Cards</h1>
    <p class="subtitle" tabindex="0">
      Monte sequ√™ncias de "c√≥digo" com cartas para atacar, defender e curar ‚Äî tudo em portugu√™s claro.
    </p>

    <!-- üîä Bot√£o para ativar modo acess√≠vel -->
    <button id="accessibilitySwitch" aria-pressed="false" aria-label="Ativar modo acess√≠vel">
      ‚ôø Acessibilidade: OFF
    </button>
  </header>

  <main class="board" role="main">
    <section class="player" id="player1" aria-label="√Årea do Jogador 1">
      <div class="banner p1" tabindex="0">Jogador 1</div>
      <div class="status">
        <div class="hp" tabindex="0">HP: <span id="hp1">20</span></div>
        <div class="energy" tabindex="0">Energia: <span id="en1">3</span></div>
      </div>

      <div class="zone">
        <h3 tabindex="0">M√£o</h3>
        <div id="hand1" class="hand" role="list" aria-label="Cartas do Jogador 1"></div>
      </div>

      <div class="zone">
        <h3 tabindex="0">√Årea de c√≥digo (m√°x 3 cartas)</h3>
        <div id="prog1" class="prog" role="list" aria-label="√Årea de c√≥digo do Jogador 1"></div>
        <div id="energy1" class="energy-total"></div>
      </div>
    </section>

    <section class="center" aria-label="Centro do campo">
      <div class="vs" tabindex="0">VS</div>
      <div class="controls" role="region" aria-label="Controles do jogo">
        <div id="turnLabel" tabindex="0">Turno: Jogador 1</div>
        <button id="runBtn" aria-label="Executar c√≥digo">Executar C√≥digo</button>
        <button id="clearBtn" aria-label="Limpar √°rea de c√≥digo">Limpar √Årea</button>
        <button id="endBtn" aria-label="Passar turno">Passar Turno</button>
      </div>

      <div class="logbox" role="log" aria-live="polite">
        <h3 tabindex="0">Registro (interpreta√ß√£o)</h3>
        <div id="log" class="log"></div>
      </div>
    </section>

    <section class="player" id="player2" aria-label="√Årea do Jogador 2">
      <div class="banner p2" tabindex="0">Jogador 2</div>
      <div class="status">
        <div class="hp" tabindex="0">HP: <span id="hp2">20</span></div>
        <div class="energy" tabindex="0">Energia: <span id="en2">3</span></div>
      </div>

      <div class="zone">
        <h3 tabindex="0">M√£o</h3>
        <div id="hand2" class="hand" role="list" aria-label="Cartas do Jogador 2"></div>
      </div>

      <div class="zone">
        <h3 tabindex="0">√Årea de c√≥digo (m√°x 3 cartas)</h3>
        <div id="prog2" class="prog" role="list" aria-label="√Årea de c√≥digo do Jogador 2"></div>
        <div id="energy2" class="energy-total"></div>
      </div>
    </section>
  </main>

  <footer class="foot" role="contentinfo">
    <small tabindex="0">
      Conceitos: sequ√™ncia, condi√ß√£o (SE), repeti√ß√£o (REPETIR X VEZES), vari√°veis (VAR).
    </small>
  </footer>

  <script src="/socket.io/socket.io.js"></script>
  <script src="script.js"></script>


  <!-- üîä Script de acessibilidade -->
  <script>
    let accessibilityEnabled = false;
    const switchBtn = document.getElementById("accessibilitySwitch");

    // Narra√ß√£o de texto
    function speak(text) {
      if (!accessibilityEnabled) return;
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "pt-BR";
      speechSynthesis.cancel(); // interrompe fala anterior
      speechSynthesis.speak(utter);
    }

    // Observar altera√ß√µes no log para narrar novas mensagens
    const logBox = document.getElementById("log");
    const observer = new MutationObserver(mutations => {
      mutations.forEach(m => {
        m.addedNodes.forEach(node => {
          if (node.textContent.trim() !== "") speak(node.textContent.trim());
        });
      });
    });
    observer.observe(logBox, { childList: true });

    // Bot√£o para alternar acessibilidade
    switchBtn.addEventListener("click", () => {
      accessibilityEnabled = !accessibilityEnabled;
      switchBtn.classList.toggle("active", accessibilityEnabled);
      switchBtn.setAttribute("aria-pressed", accessibilityEnabled);
      switchBtn.textContent = accessibilityEnabled
        ? "‚ôø Acessibilidade: ON"
        : "‚ôø Acessibilidade: OFF";
      speak(accessibilityEnabled
        ? "Modo acess√≠vel ativado. Todas as mensagens ser√£o narradas."
        : "Modo acess√≠vel desativado.");
    });

    // Fala o turno atual
    const turnLabel = document.getElementById("turnLabel");
    const turnObserver = new MutationObserver(() => {
      speak(turnLabel.textContent);
    });
    turnObserver.observe(turnLabel, { childList: true });

    // Acessibilidade via ENTER (executar bot√£o focado)
    document.addEventListener("keydown", e => {
      if (e.key === "Enter" && document.activeElement.tagName === "BUTTON") {
        document.activeElement.click();
      }
    });
  </script>
</body>

</html>